## 백업
- [파일 압축](#파일-압축)
- [백업](#백업)
<br/><br/><br/>

### 파일 압축
리눅스에서는 <code>tar</code> 명령어를 사용하여 파일을 압축, 압축해제 한다.  
이 명령어를 사용해 다양한 확장자를 가진 파일을 만들 수 있다.  

|확장자|설명|
|-------------------|-----------------------------------------------|
|.tar|쉬운 공유나 백업을 위해 디렉토리와 그 안의 파일들을 묶어 아카이빙하는 확장자이다.|
|.xz|XZ Util로 파일을 압축할 때 생기는 확장자이다. XZ Util은 Unix 및 Microsoft Window 5.0 이상 버전을 위한 데이터 압축기이다. 여타 압축기에 비해 훨씬 높은 압축률을 자랑한다.|
|.gz|gzip이라는 파일 형식으로, 파일 압축 및 해제에 사용되는 확장자이다.|

<br/>
파일 압축은 크게 두 단계로 나뉜다.<br/>
1. 파일 아카이빙(파일 모으기)<br/>
   <code>tar cvf {압축될파일명.tar} {압축할파일}</code> <br/>
2. 파일 압축<br/>
   <code>xz {파일명.tar}</code>  <br/>

이러한 두 과정을 tar 명령어의 옵션에서 z를 추가하면 파일 모으기와 압축을 함께 할 수 있다.   
<code>tar cvzf {압축될파일명.tar.gz} {압축할 파일}</code>
<br/>

파일 압축을 해제하려면 tar의 c 옵션을 x로 바꿔주면 된다.
<code>tar xvzf {압축풀파일}</code> <br/>

<br/><br/>

### 백업
백업은 자동화가 필요하다. 만약 자동화가 되어 있지 않다면 주로 백업이 실시되는 주말이나 오후 6시(제일 접속자가 적은 시간)에도 출근하여 백업을 진행해야 할 것이다. 
다행히도 리눅스에는 cron이 있다.  <br/><br/>
cron이란 Unix계열 운영체제의 작업 스케줄러이다. cron을 사용하면 반복적인 작업을 예약하여 고정된 시간, 날짜 또는 간격에 따라 주기적으로 작업이 실행되도록 할 수 있다.<br/><br/>
cron의 작업은 etc 디렉토리 아래에 있는 crontab(cron 테이블. 예약된 동작을 실시하는 셸 명령을 지정하는 구성 파일) 파일에 의해 구동된다.
```
# ┌───────────── 분 (0–59)
# │ ┌───────────── 시간(0~23)
# │ │ ┌───────────── 날짜(1~31)
# │ │ │ ┌───────────── 월(1~12)
# │ │ │ │ ┌───────────── 요일(0~6)(일요일~토요일,
# │ │ │ │ │ 7은 일부 시스템에서는 일요일이기도 합니다.
# │ │ │ │ │
# │ │ │ │ │
# * * * * * <실행할 명령>
```
각 줄의 구문에는 명령 실행 시간을 나타내는 5개의 필드로 구성된 cron 표현식과 실행할 쉘 명령어로 구성된다. 일반적으로 시간/날짜 지정 필드가 모두 현재 시간 및 날짜와 일치할 때 작업이 실행된다.
<br/><br/>
<b>문제.</b> cron을 사용하여 매 5분마다 /etc 디렉토리를 현재 디렉토리 아래에 시간이름으로 백업하라
<b>해결 방법.</b> <br/>
1. 백업 쉘 스크립트 작성<br/>
  <code> vi bakup.sh</code> <br/>
  ```
  #!bin/bash
  today=$(date+%Y%m%d)
  tar cvzf /home/jisoo/etc-$today.tar.gz /etc
  ```
주의! 쉘 스크립트 프로그래밍은 띄어쓰기 규칙을 잘 지켜주어야 한다.
<br/><br/>
2. 작성한 쉘 스크립트 권한 변경<br/>
  <code>chmod 755 backup.sh</code><br/><br/>
3. crontab에 작업 예약<br/>
<code>vi /etc/crontab</code><br/>로 crontab 연 후 파일 맨 하단에 아래 코드 추가
```
5/* * * * *   root    /home/jisoo/backup_etc/bakup.sh
```
<br/><br/>
4. ps 명령어를 통해 파일이 실행되는 것을 확인한다.
  <code>ps -ef  | grep “cron”</code>
<br/><br/>
etc 밑에는 cron.d, cron.daily, cron.houly 등과 같이 주기별로 cron 명령어를 실행하는 디렉토리가 나누어져 있다.
만약 악성코드를 발견했다면 해당 프롤그램을 삭제하는 것 뿐만 아니라 crontab을 살펴보는 것도 필수적인 과정이다. <br/><br/>
리눅스에서는 크론탭에 악성코드를 심어놓는 방식으로 해킹을 실시한다. 암호화폐 채굴 등의 목적으로 실행되며, 이 때 오버헤드가 발생하게 된다.<br/><br/>
